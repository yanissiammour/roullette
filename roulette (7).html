<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roulette EuropÃ©enne</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: #0a5028;
  min-height: 100vh;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
}

h1 {
  color: #f0d080;
  font-size: 1.05rem;
  letter-spacing: 0.22em;
  padding: 10px 0 7px;
  text-align: center;
  width: 100%;
  border-bottom: 1px solid rgba(240,208,128,0.2);
}

/* START */
#startScreen {
  position: fixed; inset: 0; background: rgba(5,35,15,0.97);
  display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 18px; z-index: 100;
}
#startScreen h2 { color: #f0d080; font-size: 1.3rem; letter-spacing: 0.2em; }
#startScreen p  { color: #aaa; font-size: 0.85rem; }
.start-input {
  width: 150px; padding: 10px; font-size: 1.2rem; font-family: monospace;
  border: 2px solid #f0d080; background: #0a3520; color: #f0d080; text-align: center; outline: none;
}
.gold-btn {
  padding: 10px 36px; font-size: 1rem; font-family: monospace;
  background: #f0d080; border: none; color: #000; cursor: pointer; font-weight: bold; letter-spacing: 0.12em;
}
.gold-btn:hover { background: #fff; }
.gold-btn:disabled { opacity: 0.35; cursor: default; }

/* LAYOUT */
#game { display: flex; width: 100%; min-height: calc(100vh - 42px); align-items: stretch; }

/* LEFT */
.left-panel {
  width: 420px; min-width: 360px; flex-shrink: 0;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 8px; padding: 16px 10px;
  border-right: 1px solid rgba(240,208,128,0.2);
  position: sticky; top: 0; height: 100vh;
}

canvas { display: block; filter: drop-shadow(0 0 28px rgba(0,0,0,0.7)); }

.result-box { font-size: 1.1rem; font-weight: bold; color: #f0d080; letter-spacing: 0.1em; min-height: 22px; text-align: center; }

.balance-row { color: #f0d080; font-size: 0.85rem; letter-spacing: 0.08em; text-align: center; }
.balance-row span { font-size: 1.2rem; font-weight: bold; }

/* Bet summary */
.bets-summary {
  width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(240,208,128,0.25);
  padding: 7px 10px; min-height: 54px; max-height: 110px; overflow-y: auto;
}
.bets-summary .title { color: rgba(240,208,128,0.6); font-size: 0.68rem; letter-spacing: 0.1em; margin-bottom: 4px; }
.bets-summary .bet-line {
  display: flex; justify-content: space-between; align-items: center;
  color: #f0d080; font-size: 0.7rem; padding: 1px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
}
.bets-summary .bet-line .rm {
  cursor: pointer; color: #ff8080; font-size: 0.65rem; padding: 0 4px;
}
.bets-summary .bet-line .rm:hover { color: #fff; }
.bets-summary .total-line {
  display: flex; justify-content: space-between;
  color: #fff; font-size: 0.75rem; font-weight: bold; margin-top: 5px; padding-top: 3px;
  border-top: 1px solid rgba(240,208,128,0.3);
}
.bets-summary .empty { color: rgba(240,208,128,0.3); font-size: 0.7rem; text-align: center; padding: 6px 0; }

/* Mise row */
.mise-row { display: flex; gap: 8px; align-items: center; }
.mise-row label { color: #ccc; font-size: 0.75rem; letter-spacing: 0.05em; }
.mise-input {
  width: 85px; padding: 7px; font-size: 0.95rem; font-family: monospace;
  border: 2px solid #f0d080; background: #083d1a; color: #f0d080; text-align: center; outline: none;
}
.quick-bets { display: flex; gap: 5px; flex-wrap: wrap; justify-content: center; }
.qb {
  padding: 3px 8px; font-size: 0.68rem; font-family: monospace;
  background: transparent; border: 1px solid rgba(240,208,128,0.4); color: #f0d080; cursor: pointer;
}
.qb:hover { background: rgba(240,208,128,0.15); }

.btn-row { display: flex; gap: 8px; }

#spinBtn {
  padding: 10px 26px; font-size: 0.95rem; font-family: monospace;
  background: #f0d080; border: 2px solid #f0d080; color: #000;
  cursor: pointer; font-weight: bold; letter-spacing: 0.1em;
}
#spinBtn:hover { background: #fff; }
#spinBtn:disabled { opacity: 0.35; cursor: default; }

#clearBtn {
  padding: 10px 14px; font-size: 0.85rem; font-family: monospace;
  background: transparent; border: 2px solid rgba(255,100,100,0.5); color: #ff8080; cursor: pointer;
}
#clearBtn:hover { background: rgba(255,80,80,0.12); }

.error-msg { color: #ff8080; font-size: 0.75rem; min-height: 14px; text-align: center; }
.gain-msg  { font-size: 0.95rem; font-weight: bold; min-height: 20px; text-align: center; letter-spacing: 0.04em; }
.gain-msg.win  { color: #80ff80; }
.gain-msg.lose { color: #ff8080; }
.gain-msg.mixed { color: #f0d080; }

/* RIGHT */
.right-panel {
  flex: 1;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 20px 14px; gap: 8px;
}

.hint { color: rgba(240,208,128,0.55); font-size: 0.72rem; letter-spacing: 0.08em; text-align: center; }

/* TABLE */
table.tapis { border-collapse: collapse; border: 2px solid #f0d080; box-shadow: 0 4px 24px rgba(0,0,0,0.5); }

table.tapis td {
  width: 50px; height: 42px;
  text-align: center; vertical-align: middle;
  border: 1px solid rgba(240,208,128,0.3);
  font-size: 0.82rem; font-weight: bold; font-family: monospace;
  cursor: pointer; user-select: none; color: #fff;
  transition: opacity 0.1s; position: relative;
}
table.tapis td:hover { opacity: 0.72; }
table.tapis td.red   { background: #c0222a; }
table.tapis td.black { background: #1a1a1a; }
table.tapis td.green0 { background: #1a7a1a; width: 42px; }
table.tapis td.out { background: #083d1a; color: #f0d080; font-size: 0.66rem; letter-spacing: 0.04em; line-height: 1.35; }
table.tapis td.out.noir-cell  { background: #111; color: #fff; }
table.tapis td.out.rouge-cell { background: #8a0f0f; color: #fff; }
table.tapis td.col-cell { background: #052e13; color: #f0d080; font-size: 0.66rem; letter-spacing: 0.04em; line-height: 1.35; width: 44px; }
table.tapis td.spacer  { background: transparent; cursor: default; }

/* chip shown on bet cell */
table.tapis td.has-bet::after {
  content: attr(data-chip);
  position: absolute; bottom: 1px; right: 2px;
  font-size: 0.58rem; background: #f0d080; color: #000;
  border-radius: 50%; width: 16px; height: 16px;
  display: flex; align-items: center; justify-content: center;
  font-weight: bold; line-height: 16px; padding: 0;
}

table.tapis td.won {
  outline: 4px solid #fff; outline-offset: -4px;
  animation: pulse 0.5s ease 3;
}
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }

/* GAME OVER */
#gameOver {
  display: none; position: fixed; inset: 0; background: rgba(5,20,10,0.93);
  flex-direction: column; align-items: center; justify-content: center; gap: 16px; z-index: 100;
}
#gameOver h2 { color: #ff4444; font-size: 1.5rem; letter-spacing: 0.2em; }
#gameOver p  { color: #ccc; font-size: 0.9rem; text-align: center; }
</style>
</head>
<body>

<h1>ðŸŽ° ROULETTE EUROPÃ‰ENNE â€” Casino de Monteâ€‘Carlo</h1>

<!-- START -->
<div id="startScreen">
  <h2>BIENVENUE AU CASINO</h2>
  <p>Choisissez votre solde de dÃ©part</p>
  <input type="number" class="start-input" id="startBal" value="500" min="10" />
  <button class="gold-btn" onclick="startGame()">ENTRER</button>
</div>

<!-- GAME -->
<div id="game" style="display:none">

  <div class="left-panel">
    <canvas id="c" width="380" height="380"></canvas>
    <div class="result-box" id="resultBox"></div>
    <div class="balance-row">Solde disponible : <span id="balEl">â€”</span> â‚¬</div>

    <!-- Active bets summary -->
    <div class="bets-summary" id="betsSummary">
      <div class="title">MISES EN COURS</div>
      <div class="empty" id="emptyMsg">Aucune mise placÃ©e</div>
    </div>

    <div class="mise-row">
      <label>MISE :</label>
      <input type="number" class="mise-input" id="miseEl" min="1" placeholder="â‚¬" value="10" />
    </div>
    <div class="quick-bets">
      <button class="qb" onclick="setMise(5)">5â‚¬</button>
      <button class="qb" onclick="setMise(10)">10â‚¬</button>
      <button class="qb" onclick="setMise(25)">25â‚¬</button>
      <button class="qb" onclick="setMise(50)">50â‚¬</button>
      <button class="qb" onclick="setMise(100)">100â‚¬</button>
    </div>

    <div class="error-msg" id="errMsg"></div>

    <div class="btn-row">
      <button class="gold-btn" id="spinBtn" onclick="spin()">TOURNER</button>
      <button id="clearBtn" onclick="clearAllBets()">âœ• Effacer</button>
    </div>

    <div class="gain-msg" id="gainMsg"></div>
  </div>

  <div class="right-panel">
    <div class="hint">Cliquez sur une case pour ajouter une mise Â· Cliquez Ã  nouveau pour ajouter encore</div>
    <table class="tapis" id="tableEl"></table>
  </div>
</div>

<!-- GAME OVER -->
<div id="gameOver">
  <h2>ðŸ’¸ GAME OVER</h2>
  <p>Vous n'avez plus d'argent.<br>Bonne chance la prochaine fois !</p>
  <button class="gold-btn" onclick="resetGame()">REJOUER</button>
</div>

<script>
// â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ORDER = [0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26];
const REDS  = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
const N = 37;

function cellClass(n) { return n === 0 ? 'green0' : REDS.has(n) ? 'red' : 'black'; }
function segColor(n)  { return n === 0 ? '#1a7a1a' : REDS.has(n) ? '#c0222a' : '#1a1a1a'; }
function range(a, b)  { return Array.from({length: b-a+1}, (_,i) => i+a); }

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let balance = 0;
let spinning = false;
let angle = -Math.PI / 2 - (2 * Math.PI / N) * 0.5;

// activeBets: array of { id, tdKey, nums, payout, label, amount }
let activeBets = [];
let betIdCounter = 0;

function totalEngaged() { return activeBets.reduce((s, b) => s + b.amount, 0); }
function availableBalance() { return balance - totalEngaged(); }

// â”€â”€ TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildTable() {
  const t = document.getElementById('tableEl');
  t.innerHTML = '';

  const colDefs = [
    { key:'c3', label:'Col. 3<br><small>2:1</small>', nums:[3,6,9,12,15,18,21,24,27,30,33,36], payout:2 },
    { key:'c2', label:'Col. 2<br><small>2:1</small>', nums:[2,5,8,11,14,17,20,23,26,29,32,35], payout:2 },
    { key:'c1', label:'Col. 1<br><small>2:1</small>', nums:[1,4,7,10,13,16,19,22,25,28,31,34], payout:2 },
  ];

  for (let row = 0; row < 3; row++) {
    const tr = t.insertRow();
    if (row === 0) {
      const td0 = tr.insertCell();
      td0.rowSpan = 3; td0.textContent = '0'; td0.className = 'green0';
      attachBet(td0, 'zero', [0], 35, 'Plein 0');
    }
    for (let cg = 0; cg < 12; cg++) {
      const n = cg * 3 + (3 - row);
      const td = tr.insertCell();
      td.textContent = n; td.className = cellClass(n);
      attachBet(td, `n${n}`, [n], 35, `Plein ${n}`);
    }
    const col = colDefs[row];
    const tdc = tr.insertCell();
    tdc.className = 'col-cell'; tdc.innerHTML = col.label;
    attachBet(tdc, col.key, col.nums, col.payout, `Colonne ${col.key.slice(1)}`);
  }

  // Douzaines
  const trD = t.insertRow();
  sp(trD);
  const douzDefs = [
    { key:'d1', label:'1Ã¨re Douzaine<br><small>1â€“12 (2:1)</small>',  nums:range(1,12),  payout:2 },
    { key:'d2', label:'2Ã¨me Douzaine<br><small>13â€“24 (2:1)</small>', nums:range(13,24), payout:2 },
    { key:'d3', label:'3Ã¨me Douzaine<br><small>25â€“36 (2:1)</small>', nums:range(25,36), payout:2 },
  ];
  douzDefs.forEach(d => {
    const td = trD.insertCell(); td.colSpan = 4; td.className = 'out';
    td.innerHTML = d.label;
    attachBet(td, d.key, d.nums, d.payout, d.label.replace(/<[^>]+>/g,'').trim());
  });
  sp(trD);

  // Outside
  const trO = t.insertRow();
  sp(trO);
  const outsideDefs = [
    { key:'manque', label:'Manque<br><small>1â€“18 (1:1)</small>',    nums:range(1,18),  payout:1, cls:'' },
    { key:'pair',   label:'Pair<br><small>(1:1)</small>',           nums:range(2,36,2),payout:1, cls:'' },
    { key:'noir',   label:'Noir<br><small>(1:1)</small>',           nums:[...Array.from({length:36},(_,i)=>i+1).filter(n=>!REDS.has(n))], payout:1, cls:'noir-cell' },
    { key:'rouge',  label:'Rouge<br><small>(1:1)</small>',          nums:[...REDS],    payout:1, cls:'rouge-cell' },
    { key:'impair', label:'Impair<br><small>(1:1)</small>',         nums:range(1,35,2),payout:1, cls:'' },
    { key:'passe',  label:'Passe<br><small>19â€“36 (1:1)</small>',    nums:range(19,36), payout:1, cls:'' },
  ];
  outsideDefs.forEach(d => {
    const td = trO.insertCell(); td.colSpan = 2;
    td.className = 'out ' + d.cls; td.innerHTML = d.label;
    attachBet(td, d.key, d.nums, d.payout, d.label.replace(/<[^>]+>/g,'').trim());
  });
  sp(trO);
}

function range(a, b, step=1) {
  const arr = [];
  for (let i = a; i <= b; i += step) arr.push(i);
  return arr;
}

function sp(tr) { const td = tr.insertCell(); td.className = 'spacer'; }

function attachBet(td, tdKey, nums, payout, label) {
  td.dataset.tdKey   = tdKey;
  td.dataset.nums    = JSON.stringify(nums);
  td.dataset.payout  = payout;
  td.dataset.label   = label;
  td.addEventListener('click', () => handleCellClick(td));
}

// â”€â”€ ADD BET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleCellClick(td) {
  if (spinning) return;
  document.getElementById('errMsg').textContent = '';
  document.getElementById('gainMsg').textContent = '';

  const miseVal = parseInt(document.getElementById('miseEl').value);
  if (isNaN(miseVal) || miseVal < 1) {
    document.getElementById('errMsg').textContent = 'Entrez une mise valide avant de cliquer.';
    return;
  }
  if (miseVal > availableBalance()) {
    document.getElementById('errMsg').textContent = `Solde insuffisant ! Disponible : ${availableBalance()}â‚¬`;
    return;
  }

  const tdKey  = td.dataset.tdKey;
  const nums   = JSON.parse(td.dataset.nums);
  const payout = parseInt(td.dataset.payout);
  const label  = td.dataset.label;

  // Check if same cell already has a bet â†’ add to it
  const existing = activeBets.find(b => b.tdKey === tdKey);
  if (existing) {
    existing.amount += miseVal;
  } else {
    activeBets.push({ id: betIdCounter++, tdKey, nums, payout, label, amount: miseVal });
  }

  updateChips();
  updateBetsSummary();
  document.getElementById('balEl').textContent = availableBalance();
}

// â”€â”€ CHIPS ON TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateChips() {
  // Reset all
  document.querySelectorAll('.tapis td[data-td-key]').forEach(td => {
    td.classList.remove('has-bet');
    delete td.dataset.chip;
  });
  activeBets.forEach(bet => {
    const td = document.querySelector(`.tapis td[data-td-key="${bet.tdKey}"]`);
    if (td) {
      td.classList.add('has-bet');
      td.dataset.chip = bet.amount + 'â‚¬';
    }
  });
}

// â”€â”€ BETS SUMMARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateBetsSummary() {
  const box = document.getElementById('betsSummary');
  const empty = document.getElementById('emptyMsg');

  // Remove old bet lines
  box.querySelectorAll('.bet-line, .total-line').forEach(el => el.remove());

  if (activeBets.length === 0) {
    empty.style.display = 'block';
    return;
  }
  empty.style.display = 'none';

  activeBets.forEach(bet => {
    const line = document.createElement('div');
    line.className = 'bet-line';
    line.innerHTML = `
      <span>${bet.label.substring(0,22)}</span>
      <span>${bet.amount}â‚¬</span>
      <span class="rm" onclick="removeBet(${bet.id})">âœ•</span>
    `;
    box.appendChild(line);
  });

  const total = document.createElement('div');
  total.className = 'total-line';
  total.innerHTML = `<span>TOTAL MISÃ‰</span><span>${totalEngaged()}â‚¬</span>`;
  box.appendChild(total);
}

function removeBet(id) {
  activeBets = activeBets.filter(b => b.id !== id);
  updateChips();
  updateBetsSummary();
  document.getElementById('balEl').textContent = availableBalance();
}

function clearAllBets() {
  if (spinning) return;
  activeBets = [];
  updateChips();
  updateBetsSummary();
  document.querySelectorAll('.tapis td.won').forEach(td => td.classList.remove('won'));
  document.getElementById('balEl').textContent = availableBalance();
  document.getElementById('gainMsg').textContent = '';
  document.getElementById('resultBox').textContent = '';
  document.getElementById('errMsg').textContent = '';
}

// â”€â”€ SPIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function spin() {
  if (spinning) return;
  const errEl = document.getElementById('errMsg');

  if (activeBets.length === 0) { errEl.textContent = 'Placez au moins une mise !'; return; }

  errEl.textContent = '';
  document.getElementById('gainMsg').textContent = '';
  document.getElementById('resultBox').textContent = '';
  document.querySelectorAll('.tapis td.won').forEach(td => td.classList.remove('won'));

  const result = ORDER[Math.floor(Math.random() * N)];
  const targetIndex = ORDER.indexOf(result);
  const seg = (2 * Math.PI) / N;
  const targetAngle = -Math.PI / 2 - (targetIndex + 0.5) * seg;

  let delta = targetAngle - angle;
  delta = ((delta % (2*Math.PI)) + 2*Math.PI) % (2*Math.PI);
  if (delta < 0.001) delta = 2*Math.PI;

  const totalRot = delta + (6 + Math.floor(Math.random() * 4)) * 2 * Math.PI;
  const duration = 5000 + Math.random() * 2000;
  const startAngle = angle, startTime = performance.now();

  spinning = true;
  document.getElementById('spinBtn').disabled = true;
  document.getElementById('clearBtn').disabled = true;

  function easeOut(t) { return 1 - Math.pow(1 - t, 3); }

  (function frame(now) {
    const t = Math.min((now - startTime) / duration, 1);
    angle = startAngle + totalRot * easeOut(t);
    draw();
    if (t < 1) { requestAnimationFrame(frame); return; }

    angle = startAngle + totalRot;
    draw();
    spinning = false;
    document.getElementById('spinBtn').disabled = false;
    document.getElementById('clearBtn').disabled = false;

    const colorName = result === 0 ? 'vert' : REDS.has(result) ? 'rouge' : 'noir';
    document.getElementById('resultBox').textContent = `â†’ ${result}  (${colorName})`;

    // Highlight result on table
    document.querySelectorAll('.tapis td[data-nums]').forEach(td => {
      try {
        const nums = JSON.parse(td.dataset.nums);
        if (nums.length === 1 && nums[0] === result) td.classList.add('won');
      } catch(e){}
    });

    // Calculate all bets
    let totalGain = 0;
    let wins = 0, losses = 0;

    activeBets.forEach(bet => {
      if (bet.nums.includes(result)) {
        totalGain += bet.amount * bet.payout;
        wins++;
      } else {
        totalGain -= bet.amount;
        losses++;
      }
    });

    // Apply to balance (remember: engaged amounts were already "reserved")
    // balance = real balance (mises not yet subtracted)
    // After spin: add winnings, subtract losses
    balance += totalGain;

    const gainMsg = document.getElementById('gainMsg');
    if (totalGain > 0) {
      gainMsg.className = 'gain-msg win';
      gainMsg.textContent = `ðŸŽ‰ +${totalGain} â‚¬  (${wins} mise(s) gagnante(s))`;
    } else if (totalGain < 0) {
      gainMsg.className = 'gain-msg lose';
      gainMsg.textContent = `ðŸ˜ž ${totalGain} â‚¬  (${losses} mise(s) perdue(s))`;
    } else {
      gainMsg.className = 'gain-msg mixed';
      gainMsg.textContent = `ðŸ¤ Ã‰quilibre â€” ni gain ni perte`;
    }

    // Clear bets after spin
    activeBets = [];
    updateChips();
    updateBetsSummary();
    document.getElementById('balEl').textContent = balance;

    if (balance <= 0) {
      setTimeout(() => {
        document.getElementById('game').style.display = 'none';
        document.getElementById('gameOver').style.display = 'flex';
      }, 1800);
    }
  })(performance.now());
}

// â”€â”€ WHEEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const cx = 190, cy = 190, R = 178, Ri = 40;
const SEG = (2 * Math.PI) / N;

function draw() {
  ctx.clearRect(0, 0, 380, 380);
  for (let i = 0; i < N; i++) {
    const num = ORDER[i];
    const s = angle + i*SEG, e = s + SEG;
    ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,R,s,e); ctx.closePath();
    ctx.fillStyle = segColor(num); ctx.fill();
    ctx.strokeStyle = 'rgba(255,255,255,0.18)'; ctx.lineWidth = 0.7; ctx.stroke();

    const mid = angle + (i+0.5)*SEG;
    const tx = cx + R*0.78*Math.cos(mid), ty = cy + R*0.78*Math.sin(mid);
    ctx.save(); ctx.translate(tx,ty); ctx.rotate(mid + Math.PI/2);
    ctx.fillStyle = '#fff'; ctx.font = 'bold 10px monospace';
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText(num, 0, 0); ctx.restore();
  }
  ctx.beginPath(); ctx.arc(cx,cy,R,0,Math.PI*2); ctx.strokeStyle='#f0d080'; ctx.lineWidth=3; ctx.stroke();
  ctx.beginPath(); ctx.arc(cx,cy,Ri,0,Math.PI*2); ctx.fillStyle='#0a5028'; ctx.fill();
  ctx.strokeStyle='#f0d080'; ctx.lineWidth=2; ctx.stroke();
  ctx.beginPath(); ctx.arc(cx,cy,5,0,Math.PI*2); ctx.fillStyle='#f0d080'; ctx.fill();
  ctx.beginPath(); ctx.moveTo(cx,cy-R-2); ctx.lineTo(cx-10,cy-R-19); ctx.lineTo(cx+10,cy-R-19);
  ctx.closePath(); ctx.fillStyle='#f0d080'; ctx.fill();
}

// â”€â”€ FLOW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startGame() {
  const v = parseInt(document.getElementById('startBal').value);
  if (isNaN(v) || v < 10) { alert('Solde minimum : 10â‚¬'); return; }
  balance = v;
  document.getElementById('balEl').textContent = balance;
  document.getElementById('startScreen').style.display = 'none';
  document.getElementById('game').style.display = 'flex';
  buildTable();
  draw();
}

function resetGame() {
  activeBets = []; spinning = false;
  document.getElementById('gameOver').style.display = 'none';
  document.getElementById('startScreen').style.display = 'flex';
  document.getElementById('gainMsg').textContent = '';
  document.getElementById('resultBox').textContent = '';
}

function setMise(v) { document.getElementById('miseEl').value = v; }
document.getElementById('startBal').addEventListener('keydown', e => { if (e.key==='Enter') startGame(); });
</script>
</body>
</html>
